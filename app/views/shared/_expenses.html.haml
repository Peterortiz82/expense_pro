.panel.panel-default
  .table-responsive
    %table.table.table-bordered
      %tr
        %th= sort_link @search, :expense_date, 'Date'
        - if Feature.active?(:invite_user)
          %th= sort_link @search, :user_display_name, 'Person'
        %th= sort_link @search, :category_id
        %th  Expense
        %th= sort_link @search, :amount
        %th  Description
        %th  Edit/Delete
      - @expenses.each do |expense|
        %tr
          %td= expense.expense_date.strftime("%B %d, %Y")
          - if Feature.active?(:invite_user)
            %td= expense.user.display_name
          -if expense.category
            %td= expense.category.name
          -else
            %td= 'Other'
          -if expense.sub_category && expense.category.id != 15
            %td= expense.sub_category.name
          -else
            %td= expense.name
          %td= number_to_currency expense.amount
          %td= expense.description.present? ? (auto_link expense.description) : 'N/A'
          %td
            = link_to 'Edit', edit_list_expense_path(@list, expense)
            |
            = link_to 'Delete', list_expense_path(@list, expense), method: :delete, data: {confirm: "Are you sure?"}
.well.well-sm
  .total
    - if params[:q].blank? || params[:q].has_key?(:s)
      = "Total: #{number_to_currency @sum_of_expenses}"
    - else
      = "Total: #{number_to_currency @sum_of_search_results}"
= will_paginate @expenses
= link_to 'Log Expense', new_list_expense_path(@list), class: 'btn btn-primary pull-right'